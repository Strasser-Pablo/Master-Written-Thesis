\chapter{Analytical problem and analytical result}

\minitoc
\section*{Introduction}
In this chapter, we will discuss the analytical problem that we want to solve.
The other numerical chapters will consist of numericals schemes to solve the problem given in this chapter.

\section{Variables and parameters}

The problem will consist to find a function of space and time in a certain domain respecting some conditions and equations.

We begin to define space, time and domain:
\begin{description}
\item[The \emph{space}] consists of a vector in fixed Cartesian coordinate with dimension typically 2 or 3 (Navier-Stokes on 1d is trivial).
Space is noted $\vect{x}$.
\item[The \emph{time}] consists of a indice indicating the evolution of the function in time.
Time is noted $t$.
\item[The \emph{domain}] is the spatial region where a field is defined. This consists physically in the spatial region where water lies.
Boundary conditions need to be provided.
The domain can vary with respect of time and can vary with respect of the solution at previous time.
The domain doesn't need to be connected. But can be decomposed in union of connected subdomain.

\begin{example}
 If we take a drop of water falling in a glass of water. The domain consist of the region where the water lies.
 At the beginning this will consist of domain consisting of two connected subdomains (the drop and the glass)
 that after a given time will merge in one domain.
\end{example}

The domain is generally noted $\Omega$ or $\Omega(t)$ to emphasize that it can be variable with respect of time.
\end{description}

The variable of the equation are named \emph{Field} and consists of functions with respect of space in the spatial domain and time in the temporal domain.
\begin{equation}
 F(x,t)\qquad \text{With $x\in\Omega(t)$ and $t_0\leq t \leq t_f$}
\end{equation}

We have the following fields:
\begin{description}
\item[The \emph{speed}:] A vector field consisting of the speed in space and time.
The speed is noted $\vect{v}$.
\item[The \emph{pressure}:] A scalar field consisting of an internal force per unit area in the fluid.
We will not use the pressure in this work, but the pressure divided by density.
If we note the pressure $\tilde{p}$ we use:
\begin{equation}
 p=\frac{\tilde{p}}{\rho}
\end{equation}
Because we use incompressible Navier-Stokes equation, $\rho$ is constant. This can be view as a change of unit.
\end{description}

The following constant parameters are used:
\begin{description}
\item[The \emph{viscosity}] represents how much water particles stick together.
Higher is the viscosity less abrupt speed changes are possible.
The viscosity is noted $\mu$. We use allot $\nu$ that is the viscosity divided by the density.
\begin{equation}
 \nu=\frac{\mu}{\rho}
\end{equation}
\item[The \emph{density}] is a mass per unit volume.
Density play the same role as mass in Newton's mechanic.
In the incompressible Navier-Stokes equation density is a constant because incompressibility tells us that density doesn't change.
The density is noted $\rho$.
\item[The \emph{external force}] is a user defined vector field that represents the external force applied to the water.
It can possibly depends on the solution for previous time.
The force is noted $\vect{F}$.
\end{description}

\section{Navier-Stokes equations}

\subsection{Fixed eulerian topology}
\label{analytical:fixe_eulerian}
The incompressible Navier-Stokes equations are given by:
\begin{subequations}
\begin{align}
\label{analytical:navierStokesA}
\vect{\nabla} \cdot \vect{v}(\vect{x} ,t)&=0\\
\label{analytical:navierStokesB}
\partial_t \vect{v}(\vect{x} ,t)+(\vect{v}(\vect{x},t)\cdot\vect{\nabla} ) \vect{v}(\vect{x} ,t)&=-\vect{\nabla} p(\vect{x},t)+\frac{\vect{F}(\vect{x},t)}{\rho(\vect{x},t)}+\nu \Delta \vect{u}(\vect{x},t)
\end{align}
\end{subequations}

Equation \ref{analytical:navierStokesA}, tells us that the speed is a divergence free field.
Equation \ref{analytical:navierStokesB} is an equation of evolution. The presence of $p$ allows to maintain the speed always divergence free.
Taking the rotational of \ref{analytical:navierStokesB} make disappear the pressure term (because the rotational of a gradient is 0).

The pressure term can be seen as a correction of the divergence without changing the rotational.

We can rewrite Navier-Stokes equations as:
\begin{subequations}
\begin{align}
\label{analytical:navierStokesRewA}
\vect{\nabla} \cdot \vect{v}(\vect{x} ,t)&=0\\
\label{analytical:navierStokesRewB}
\partial_t \vect{v}(\vect{x} ,t)&=f(\vect{v}(\vect{x},t))-\vect{\nabla}p
\intertext{Where}
f(\vect{v}(\vect{x},t))&=-(\vect{v}(\vect{x},t)\cdot\vect{\nabla} ) \vect{v}(\vect{x} ,t)+\frac{\vect{F}(\vect{x},t)}{\rho(\vect{x},t)}+\nu \Delta \vect{u}(\vect{x},t)
\end{align}
\end{subequations}

Taking the divergence of equation \ref{analytical:navierStokesRewB} we found:
\begin{equation}
  \Delta p=\vect{\nabla}\cdot f(\vect{v})
\end{equation}
But using the notation of \ref{introduction:projectiondef}:
\begin{equation}
	-\vect{\nabla}p=P(f(\vect{v}))
\end{equation}

The equations of Navier-Stokes are then equivalent to solve:
\begin{equation}
  \partial_t \vect{v}(\vect{x} ,t)=f(\vect{v}(\vect{x},t))+P(f(\vect{v}(\vect{x},t))=(\eye+P)f(\vect{v}(\vect{x},t))
\end{equation}
$(\eye+P)$ is a projector on a divergence free space without changing the rotational.

\subsection{Mobile eulerian topology }
When topology is variable, we need to add another equation to tell where is the domain of computation.
A natural boundary condition is the free surface, wich moves with the speed at given point.

We define $\lambda$ a system of representative. And $\vect{\xi}_{\lambda}$ the position of point given by $\lambda$.
The domain is given by the union of $\vect{\xi}$ for all $\lambda$.

The Navier-Stokes equations are now:
\begin{subequations}
\begin{align}
\label{analytical:navierStokesMobA}
\vect{\nabla} \cdot \vect{v}(\vect{x} ,t)&=0\\
\label{analytical:navierStokesMobB}
\partial_t \vect{v}(\vect{x} ,t)+(\vect{v}(\vect{x},t)\cdot\vect{\nabla} ) \vect{v}(\vect{x} ,t)&=-\vect{\nabla} p(\vect{x},t)+\frac{\vect{F}(\vect{x},t)}{\rho(\vect{x},t)}+\nu \vect{\Delta} \vect{u}(\vect{x},t)\\
\partial_t \vect{\xi}_{\lambda}(t)&=\vect{v}(\vect{\xi}_{\lambda},t)
\end{align}
\end{subequations}
We can as in section \ref{analytical:fixe_eulerian} eliminate the constrain on the divergence with the same notation:
\begin{subequations}
\begin{align}
\partial_t \vect{v}(\vect{x} ,t)&=f(\vect{v}(\vect{x},t))+P(f(\vect{v}(\vect{x},t))=(\eye+P)f(\vect{v}(\vect{x},t))\\
\partial_t \vect{\xi}_{\lambda}(t)&=\vect{v}(\vect{\xi}_{\lambda},t)\label{ana:move:equ}
\end{align}
\end{subequations}

\subsection{Lagrangian form of Navier-Stokes equations}
\label{analytical:convectif}
We will in this section rewrite \ref{analytical:navierStokesB} in another form.
We begin to define a new position system (which is similar to the particle position used in previous section) $\vect{\xi}_{\lambda}(t)$:
\begin{subequations}
\begin{align}
 \partial_t \vect{\xi}_{\lambda}(t)&=\vect{v}(\vect{\xi}_{\lambda}(t),t)\\
 \vect{\xi}_{\lambda}(t_0)&=\vect{\xi}^{0}_{\lambda}
\end{align}
\end{subequations}
$\lambda$ is a system of representative that is initialized by initial condition.
For a given $\lambda$, $\vect{\xi}_{\lambda}(t)$ follows the speed at the given point.
This position system is called particle coordinate or Lagrangian.
$\vect{\xi}_\lambda(t)$ is called the characteristic.

We then can define the Lagrangian speed.
\begin{equation}
 \vect{u}_{\lambda}(t)=\vect{v}(\vect{\xi}_{\lambda}(t),t)
\end{equation}
The Lagrangian speed is the speed following a characteristic.

Taking the total derivative (the derivative of everything that depend on time) of the Lagrangian speed with respect of time, we have:
\begin{equation}
\frac{d \vect{u}_{\lambda}(t)}{d t}=\frac{d \vect{v}(\xi_{\lambda},t)}{d t}=\partial_t \vect{v}+\left(\frac{\partial \vect{\xi}_{\lambda}(t)}{\partial t}\cdot\vect{\nabla}\right)\vect{v}
\end{equation}
This can be rewritten:
\begin{equation}
\frac{d \vect{u}_{\lambda}(t)}{d t}=\partial_t \vect{v}+\left(\vect{v} \cdot\vect{\nabla}\right)\vect{v}
\end{equation}
This is exactly the lhs of equation \ref{analytical:navierStokesB}.

We then can rewrite Navier-Stokes equations as:
\begin{subequations}
\begin{align}
\label{analytical:navierStokesLagA}
\vect{\nabla} \cdot \vect{u}_{\lambda}(t)&=0\\
\label{analytical:navierStokesLagB}
\frac{d \vect{u}_{\lambda}(t)}{d t}&=-\vect{\nabla} p(\vect{\xi}_{\lambda}(t),t)+\frac{\vect{F}(\vect{\xi}_{\lambda}(t),t)}{\rho(\vect{x},t)}+\nu \Delta \vect{u}_{\lambda}(t)
\end{align}
\end{subequations}

\begin{remark}
We remark that with this notation some expression like spatial derivative of $\vect{u}$ is not defined.
In an analytical procedure, we can transform $\vect{u}$ to $\vect{v}$ with the help of the expression of $\vect{\xi}$, then the derivative is well defined.
But in a numerical procedure, the point where the values are know are particles. This demand to define derivative on unstructured grid
or to interpolate at grid point.
\end{remark}

\section{Boundary conditions}

We will be interested in two kinds of boundary conditions.
\begin{description}
 \item[\emph{Inflow} Boundary:]
 An inflow boundary is a source of water.
 \item[\emph{free surface} Boundary:]
 A free surface boundary is a freely moving boundary where the other fluid is inert.
\end{description}

\subsection{Inflow}

Inflow boundary conditions have a constant prescribed speed.
This give the following constraint on pressure:
\begin{equation}
\nabla p(\vect{x},t)=f(\vect{v}(\vect{x},t))
\end{equation}

The following alternative boundary conditions have been used.
Set the speed on the surface artificially to constant and use 0 Neumann boundary conditions.


\subsection{Free surface}
\label{ana:free:surface}
To define the free surface boundary conditions, we need to define the stress tensor:
\begin{equation}
	\sigma_{ij}=-p \delta_{ij}+\nu\left(\frac{\partial v_{i}}{\partial x_{j}}+\frac{\partial v_{j}}{\partial x_{i}}\right)
\end{equation}
The boundary conditions are then given by (for 3d):
\begin{align}
	\sum_{i,j}\sigma_{ij}n_{i}n_{j}&=0\\
	\sum_{i,j}\sigma_{ij}t^{1}_{i}n_{j}&=0\\
	\sum_{i,j}\sigma_{ij}t^{2}_{i}n_{j}&=0\\
\end{align}
Where $\vect{n}$ is the normal vector and $\vect{t}^1$ and $\vect{t}^2$ are two non-colinear tangent vectors.
For 2d only one tangent vector is needed.

The first equation can be used to find boundary conditions for $p$.
The other equations only depend of speed, because $\vect{n}$ is orthogonal to $\vect{t}^{1}$ and $\vect{t}^{2}$.
The value of $\nu$ is not relevant for the condition (a global non zero constant).
The constraint is linear.